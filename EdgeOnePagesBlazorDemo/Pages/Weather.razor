@page "/weather"
@inject HttpClient Http

<PageTitle>Weather</PageTitle>

<MudStack Spacing="2" Class="mb-4">
    <MudText Typo="Typo.h4">天气预报</MudText>
    <MudText Typo="Typo.subtitle1">
        通过 MudTable 展示从 <code>sample-data/weather.json</code> 加载的示例数据。
    </MudText>
</MudStack>

@if (forecasts == null)
{
    <MudPaper Class="pa-6" Style="display:flex;justify-content:center;">
        <MudProgressCircular Size="Size.Large" Color="Color.Primary" />
    </MudPaper>
}
else
{
    <MudCard>
        <MudCardHeader>
            <MudText Typo="Typo.h6">未来 5 天</MudText>
        </MudCardHeader>
        <MudTable Items="forecasts" Hover="true" Dense="true" Breakpoint="Breakpoint.Sm">
            <HeaderContent>
                <MudTh>日期</MudTh>
                <MudTh>温度 (°C)</MudTh>
                <MudTh>温度 (°F)</MudTh>
                <MudTh>概述</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="日期">@context.Date.ToShortDateString()</MudTd>
                <MudTd DataLabel="温度 (°C)">@context.TemperatureC</MudTd>
                <MudTd DataLabel="温度 (°F)">@context.TemperatureF</MudTd>
                <MudTd DataLabel="概述">
                    <MudChip Color="Color.Secondary" Variant="Variant.Text">@context.Summary</MudChip>
                </MudTd>
            </RowTemplate>
        </MudTable>
    </MudCard>
}

@code {
    private WeatherForecast[]? forecasts;

    protected override async Task OnInitializedAsync()
    {
        forecasts = await Http.GetFromJsonAsync<WeatherForecast[]>("sample-data/weather.json");
    }

    public class WeatherForecast
    {
        public DateOnly Date { get; set; }

        public int TemperatureC { get; set; }

        public string? Summary { get; set; }

        public int TemperatureF => 32 + (int)(TemperatureC / 0.5556);
    }
}
